

<!DOCTYPE html>

<html lang="fr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>√âditeur CSV avec Options Avanc√©es</title>

    <style>

        body {

            font-family: 'Arial', sans-serif;

            background-color: #f4f4f9;

            margin: 0;

            padding: 20px;

            color: #333;

        }

        h1 {

            text-align: center;

            color: #4CAF50;

            font-size: 2.5em;

            margin-bottom: 20px;

        }

        .container {

            max-width: 1200px;

            margin: 0 auto;

            background-color: white;

            padding: 30px;

            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);

            border-radius: 10px;

        }

        table {

            border-collapse: collapse;

            width: 100%;

            margin: 20px 0;

        }

        table, th, td {

            border: 1px solid #ddd;

        }

        th, td {

            padding: 15px;

            text-align: left;

        }

        th {

            background-color: #4CAF50;

            color: white;

            cursor: pointer;

        }

        td.editable {

            background-color: #f9f9f9;

        }

        input[type="file"], input[type="text"], select, button {

            margin: 10px 5px;

            padding: 10px;

            border-radius: 5px;

            border: 1px solid #ccc;

        }

        .format-button {

            margin: 10px 5px;

            padding: 10px 15px;

            font-size: 16px;

            border-radius: 5px;

            border: none;

            background-color: #4CAF50;

            color: white;

            cursor: pointer;

            transition: background-color 0.3s;

        }




        .format-button:hover {

            background-color: #45a049;

        }




        @media (max-width: 600px) {

            .format-button {

                font-size: 14px;

                padding: 8px 12px;

            }

        }




        @media (min-width: 601px) {

            .format-button {

                font-size: 16px;

                padding: 10px 15px;

            }

        }

        .button-container {

            display: flex;

            flex-wrap: wrap;

            gap: 10px; /* Espace entre les boutons */

            align-items: center; /* Aligner les boutons verticalement */

        }

        .button-container button, 

        .button-container input[type="file"], 

        .button-container input[type="text"] {

            margin: 5px;

            padding: 10px;

            font-size: 14px;

            min-width: 100px; /* Largeur minimale pour les petits √©crans */

            flex-shrink: 0; /* Emp√™che les boutons de se r√©duire trop */

        }

        .button-container label {

            margin-right: 10px;

        }




        /* Responsive pour petits √©crans */

        @media (max-width: 600px) {

            .button-container {

                flex-direction: column; /* Empile les boutons en colonne pour petits √©crans */

            }

        }

        button {

            background-color: #4CAF50;

            color: white;

            cursor: pointer;

            transition: background-color 0.3s;

            border: none;

            font-size: 1.1em;

        }

        button:hover {

            background-color: #45a049;

        }

        .color-option {

            display: inline-block;

            width: 30px;

            height: 30px;

            border-radius: 50%;

            margin: 0 5px;

            cursor: pointer;

            transition: transform 0.2s;

        }

        .color-option:hover {

            transform: scale(1.2);

        }

        .color-red { background-color: #FF6347; }

        .color-blue { background-color: #1E90FF; }

        .color-green { background-color: #32CD32; }

        .color-yellow { background-color: #FFD700; }

        .color-purple { background-color: #9370DB; }

        .color-lightgray { background-color: #D3D3D3; }

        .color-orange { background-color: #FFA500; }

        .color-lightblue { background-color: #ADD8E6; }

        .color-pink { background-color: #FFC0CB; }

        .color-teal { background-color: #008080; }

        .color-beige { background-color: #F5F5DC; }

        .color-lightgreen { background-color: #90EE90; }

        .color-salmon { background-color: #FA8072; }

        .color-lavender { background-color: #E6E6FA; }

        .color-mint { background-color: #98FF98; }

        .color-peach { background-color: #FFDAB9; }

        .color-skyblue { background-color: #87CEEB; }

        .color-coral { background-color: #FF7F50; }

        .selected { border: 2px solid black; }




        .pagination {

            display: flex;

            justify-content: center;

            margin-top: 20px;

        }

        .pagination button {

            margin: 0 5px;

        }

        @media print {

            body * {

                visibility: hidden;

            }

            #csvTable, #csvTable * {

                visibility: visible;

            }

            #csvTable {

                position: absolute;

                left: 0;

                top: 0;

            }

        }

    </style>

</head>

<body>

    <div class="container">

        <h1>√âditeur de fichiers CSV Avanc√©</h1>

        <div class="button-container">

            <input type="file" id="csvFile" accept=".csv" />

            <button onclick="addRow()">‚ûï Ajouter une ligne</button>

            <button onclick="deleteColumn()">üóëÔ∏è Supprimer colonne</button>

            <button onclick="deleteEmptyRows()">üßπ Supprimer lignes vides</button>

            <button onclick="mergeCSV()">üîó Fusionner CSV</button>

            <button onclick="detectDuplicates()">üîç D√©tecter les doublons</button>

            <button onclick="resetTable()">üîÑ R√©initialiser le tableau</button>

            <button onclick="printTable()">üñ®Ô∏è Imprimer</button>

            <button onclick="exportHTML()">üìÑ Exporter HTML</button>

            <label for="fileNameInput">Nom du fichier CSV :</label>

            <input type="text" id="fileNameInput" placeholder="Entrez le nom du fichier (sans extension)" />

            <button onclick="exportCSV()">üíæ Exporter CSV</button>

            <button onclick="mergeCells()">‚öôÔ∏è Fusionner cellules</button>

            <button onclick="undo()">‚Ü©Ô∏è Annuler</button>

            <button onclick="redo()">‚Ü™Ô∏è Refaire</button>

        </div>

    </div>




    <br><br>




    <label for="searchInput">Rechercher :</label>

    <input type="text" id="searchInput" placeholder="Rechercher..." onkeyup="searchTable()">

    <label for="replaceInput">Remplacer :</label>

    <input type="text" id="replaceInput" placeholder="Remplacer..." />

    <button onclick="replaceInTable()">Remplacer</button>

    <label for="fillColumn">Remplir colonne avec :</label>

    <input type="text" id="fillColumnValue" placeholder="Entrez une valeur" />

    <button onclick="fillColumn()">Remplir</button>




    <br><br>




    <label for="columnSelector">S√©lectionner une colonne :</label>

    <select id="columnSelector">

        <option value="-1">Aucune</option>

    </select>




    <br><br>




    <label>Couleur :</label>

    <div id="colorPalette">

        <div class="color-option color-red" onclick="selectTextColor('red')"></div>

        <div class="color-option color-blue" onclick="selectTextColor('blue')"></div>

        <div class="color-option color-green" onclick="selectTextColor('green')"></div>

        <div class="color-option color-yellow" onclick="selectTextColor('yellow')"></div>

        <div class="color-option color-purple" onclick="selectTextColor('purple')"></div>

        <div class="color-option color-lightgray" onclick="selectTextColor('lightgray')"></div>

        <div class="color-option color-orange" onclick="selectTextColor('orange')"></div>

        <div class="color-option color-lightblue" onclick="selectTextColor('lightblue')"></div>

        <div class="color-option color-pink" onclick="selectTextColor('pink')"></div>

        <div class="color-option color-teal" onclick="selectTextColor('teal')"></div>

        <div class="color-option color-beige" onclick="selectTextColor('beige')"></div>

        <div class="color-option color-lightgreen" onclick="selectTextColor('lightgreen')"></div>

        <div class="color-option color-salmon" onclick="selectTextColor('salmon')"></div>

        <div class="color-option color-lavender" onclick="selectTextColor('lavender')"></div>

        <div class="color-option color-mint" onclick="selectTextColor('mint')"></div>

        <div class="color-option color-peach" onclick="selectTextColor('peach')"></div>

        <div class="color-option color-skyblue" onclick="selectTextColor('skyblue')"></div>

        <div class="color-option color-coral" onclick="selectTextColor('coral')"></div>

    </div>




    <br>




    <label for="rowsPerPage">Lignes par page :</label>

    <input type="number" id="rowsPerPage" value="20" min="1" max="100" />




    <table id="csvTable">

        <thead id="csvHeader"></thead>

        <tbody id="csvBody"></tbody>

    </table>




    <div class="pagination">

        <button onclick="prevPage()">Pr√©c√©dent</button>

        <button onclick="nextPage()">Suivant</button>

    </div>




    <label for="fontSelector">Changer police :</label>

    <select id="fontSelector" onchange="changeFont()">

        <option value="Arial">Arial</option>

        <option value="Verdana">Verdana</option>

        <option value="Helvetica">Helvetica</option>

        <option value="Times New Roman">Times New Roman</option>

        <option value="Georgia">Georgia</option>

        <option value="Courier New">Courier New</option>

        <option value="Trebuchet MS">Trebuchet MS</option>

        <option value="Comic Sans MS">Comic Sans MS</option>

        <option value="Impact">Impact</option>

        <option value="Tahoma">Tahoma</option>

    </select>






    <br><br>




    <button class="format-button" onclick="boldText()">Mettre en Gras</button>

    <button class="format-button" onclick="italicizeText()">Mettre en Italique</button>

    <button class="format-button" onclick="underlineText()">Souligner</button>

    <button class="format-button" onclick="changeTextColor()">Changer Couleur</button>

    <button class="format-button" onclick="highlightText()">Surligner</button>

    <button class="format-button" onclick="increaseFontSize()">Augmenter Taille</button>

    <button class="format-button" onclick="decreaseFontSize()">Diminuer Taille</button>

    <button class="format-button" onclick="resetFormatting()">R√©initialiser Formatage</button>






    <br><br>

    

</div>






<script>

    let csvData = [];

    let originalCsvData = [];

    let selectedColumns = {};

    let currentPage = 1;

    let rowsPerPage = 20;

    let rowsToPrint = 20;

    let highlightedCells = new Set();

    let history = [];

    let redoStack = [];

    let sortOrder = {}; // Objet pour stocker l'ordre de tri de chaque colonne

    let selectedCell = null;






    document.getElementById('rowsPerPage').addEventListener('change', function() {

        rowsPerPage = parseInt(this.value);

        rowsToPrint = parseInt(this.value);

        currentPage = 1;

        paginateTable();

    });




    document.getElementById('csvFile').addEventListener('change', function(e) {

        const file = e.target.files[0];

        const reader = new FileReader();




        reader.onload = function(event) {

            const csv = event.target.result;

            parseCSV(csv);

        };




        reader.readAsText(file);

    });




    function parseCSV(csv) {

        // D√©tecte si le CSV utilise des virgules, des points-virgules ou des tabulations comme s√©parateur

        const separator = csv.includes(';') ? ';' : csv.includes('\t') ? '\t' : ',';




        // Divise le CSV en lignes et en colonnes selon le s√©parateur d√©tect√©

        const rows = csv.split('\n').map(row => row.split(separator));




        // Filtre les lignes vides ou mal format√©es

        const filteredRows = rows.filter(row => row.some(cell => cell.trim() !== ''));




        // S√©pare les m√©ta-lignes et les donn√©es si besoin (par exemple, des lignes avec moins de 2 colonnes)

        const metaRows = filteredRows.filter(row => row.length <= 2);

        const dataRows = filteredRows.filter(row => row.length > 2);




        // Stocke les donn√©es et cr√©e une copie originale

        csvData = metaRows.concat(dataRows);

        originalCsvData = JSON.parse(JSON.stringify(csvData));




        // Affiche les donn√©es dans le tableau

        displayTable();




        // Remplit le s√©lecteur de colonnes pour les actions sur colonnes

        if (dataRows.length > 0) {

            populateColumnSelector(dataRows[0].length);

        } else {

            alert('Le fichier CSV semble vide ou mal format√©.');

        }

    }






    function displayTable() {

        const tableHeader = document.getElementById('csvHeader');

        const tableBody = document.getElementById('csvBody');




        tableHeader.innerHTML = '';

        tableBody.innerHTML = '';




        if (csvData.length > 0) {

            const headerRow = document.createElement('tr');

            

            // Parcourt les cellules de la premi√®re ligne (les en-t√™tes) pour les afficher et colorer

            csvData[0].forEach((cell, index) => {

                const th = document.createElement('th');

                th.textContent = cell;

                th.style.backgroundColor = '#1E90FF'; // Appliquer la couleur bleue aux colonnes d√©tect√©es

                th.onclick = () => sortTableByColumn(index); // Tri par colonne lors d'un clic

                headerRow.appendChild(th);

            });




            const thDelete = document.createElement('th');

            thDelete.textContent = 'Actions';

            headerRow.appendChild(thDelete);

            tableHeader.appendChild(headerRow);




            // Affichage des lignes de donn√©es

            for (let i = 1; i < csvData.length; i++) {

                const row = document.createElement('tr');

                csvData[i].forEach((cell, index) => {

                    const td = document.createElement('td');

                    td.contentEditable = true;

                    td.classList.add('editable');

                    td.textContent = cell;

                    row.appendChild(td);

                });




                const deleteButton = document.createElement('td');

                deleteButton.innerHTML = `<button onclick="deleteRow(${i})">Supprimer</button>`;

                row.appendChild(deleteButton);

                tableBody.appendChild(row);

            }




            paginateTable();

        } else {

            alert("Le fichier CSV est vide ou mal format√©.");

        }

    }










    function addRow() {

        // V√©rifie s'il existe au moins une ligne dans csvData pour conna√Ætre le nombre de colonnes

        if (csvData.length > 0) {

            // R√©cup√®re le nombre de colonnes √† partir de la premi√®re ligne

            const columnCount = csvData[0].length;




            // Cr√©e une nouvelle ligne avec le m√™me nombre de colonnes

            const newRow = new Array(columnCount).fill('');




            // Sauvegarder l'√©tat pour permettre annulation

            saveState();




            // Ajoute la nouvelle ligne au tableau CSV

            csvData.push(newRow);




            // Met √† jour l'affichage du tableau

            displayTable();

        } else {

            // Si le tableau est vide, cr√©e une ligne avec un nombre de colonnes par d√©faut, par exemple 6

            const defaultColumnCount = 6;

            const newRow = new Array(defaultColumnCount).fill('');




            saveState();

            csvData.push(newRow);

            displayTable();

        }

    }




    function deleteColumn() {

        const columnSelector = document.getElementById('columnSelector');

        const selectedColIndex = parseInt(columnSelector.value);

        if (selectedColIndex !== -1 && confirm("√ätes-vous s√ªr de vouloir supprimer cette colonne ?")) {

            saveState();

            csvData.forEach(row => row.splice(selectedColIndex, 1));

            displayTable();

        }

    }




    function deleteEmptyRows() {

        saveState();

        csvData = csvData.filter(row => row.some(cell => cell.trim() !== ''));

        displayTable();

    }




    function exportCSV() {

        try {

            let fileName = document.getElementById('fileNameInput').value.trim();

            

            // V√©rifie si le nom de fichier est vide

            if (!fileName) {

                alert("Veuillez sp√©cifier un nom de fichier.");

                return;  // Sort de la fonction si aucun nom n'est sp√©cifi√©

            }




            // Cr√©er le contenu CSV

            let csvContent = csvData.map(e => e.join(",")).join("\n");

            

            // V√©rifie s'il y a des donn√©es √† exporter

            if (csvData.length === 0 || !csvContent) {

                alert("Aucune donn√©e √† exporter.");

                return; // Sort de la fonction s'il n'y a pas de donn√©es

            }




            // Cr√©e le fichier Blob et d√©clenche le t√©l√©chargement

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });

            const link = document.createElement("a");

            const url = URL.createObjectURL(blob);

            link.setAttribute("href", url);
